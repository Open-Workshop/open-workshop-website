{% extends 'html-partials/standart.html' %}
{% block content %}
    <div style="display: flex; flex-direction: column; align-items: center;">
      <article style="display: flex; width: 900pt; max-width: 100%; justify-content: center; padding: 0;">
        <div class="standart-panel" style="position: absolute; display: flex;">
          <div class="standart-panel navigation">
            <button>
              <img src="/assets/images/home-ico.svg" alt="Иконка 'домой'">
            </button>
            <button>
              <img src="/assets/images/image-ico.svg" alt="Иконка 'каталог'">
            </button>
            <button>
              <img src="/assets/images/params-ico.svg" alt="Иконка 'параметры'">
            </button>
          </div>
          <div class="standart-panel navigation">
            <button style="background-color: #FFF8D3;">
              <img src="/assets/images/save-ico.svg" alt="Иконка 'сохранить'">
            </button>
          </div>
        </div>

        <div style="width: 100%; display: flex; margin: 3.5pt;">
          <div style="width: 70%;">
            <input dynamlen empty-width="160pt" placeholder="Название игры" type="text" class="title-mod" startdata="{{ data[0]['result']['name'] }}" value="{{ data[0]['result']['name'] }}">
            
            <div style="margin: 5pt; padding: 5pt; background-color: rgba(0, 0, 0, 0.2); border-radius: 20pt;">
              <div style="display: flex; justify-content: space-between;">
                <div class="navigation">
                  <button onclick="fullEditView(false)">
                    <img src="/assets/images/edit-ico.svg" alt="Иконка 'редактирование'">
                  </button>
                  
                  <button onclick="fullEditView(true)">
                    <img src="/assets/images/eye-ico.svg" alt="Иконка 'предпросмотр'">
                  </button>
                </div>

                <div class="navigation">
                  <button onclick="toggleHelpMode($(this))">
                    <img src="/assets/images/info-ico.svg" alt="Иконка 'туториал'">
                  </button>
                </div>
              </div>

              {% with limit=10000, placeholder='Описание не может быть пустым!(', init_text=data[0]['result']['description'] %}
                {% include 'html-partials/desc-edit.html' %}
              {% endwith %} 

              <article id="mod-description" style="display: none;"></article>
            </div>
          </div>

          <div style="width: 30%;">
            ...
          </div>
        </div>
      </article>
    </div>

    <style>
      div.navigation {
        display: flex;
      }

      div.navigation > button {
        border-radius: 7pt;
        background-color: #D9D9D9;
        border: none;
        width: 35pt;
        height: 35pt;
        margin: 1pt;
        transition: all 0.1s;
      }
      div.navigation > button:hover {
        background-color: #c5c5c5;
      }
      div.navigation > button:active {
        background-color: #b3b3b3;
      }

      div.navigation > button.toggle {
        background-color: #9899ac;
      }
      div.navigation > button.toggle:hover {
        background-color: #7e7f8f;
      }
      div.navigation > button.toggle:active {
        background-color: #6c6d7a;
      }
      
      div.standart-panel {
        background-color: rgba(15, 15, 15, 0.4);
        border-radius: 5pt;
        padding: 3pt;
      }

      input.title-mod {
        border-radius: 1pt;
        border-top-left-radius: 10pt;
        border-bottom-right-radius: 10pt;

        margin-left: -4pt;
        margin-top: -4pt;

        background: #302E3F;
        border: solid #939393;
        color: white;

        max-width: calc(75% - 105pt);
        font-size: 20pt;
        outline: none;
        transition: border background 0.1s;
      }
      input.title-mod:hover {
        border: solid #7e7e7e;
        background: #2b2938;
      }
      input.title-mod:focus {
        border: solid #6b6b6b;
        background: #252330;
      }
    </style>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js'></script>
    <script src="/assets/scripts/ow-prism.js"></script>
    <script src="/assets/scripts/ow-logic.js"></script>
    <script src="/assets/scripts/vendors/desc-edit.js"></script>
    <link rel="stylesheet" href="/assets/styles/vendors/ow-language.css">

    <script>
      const $fullModDescView = $('article#mod-description')
      const $fullModDescEdit = $('div[limit=10000]#desc-edit')
      const $fullModDescEditArea = $fullModDescEdit.find('textarea.editing')


      function fullEditView(mode) {
        if (mode) {
          $fullModDescEdit.hide()
          $fullModDescView.show()

          console.log($fullModDescEditArea.val())

          $fullModDescView.html(OpenWS.syntaxToHTML($fullModDescEditArea.val()))
        } else {
          $fullModDescEdit.show()
          $fullModDescView.hide()
        }
      }

      function toggleHelpMode(button) {
        if ($fullModDescEditArea.hasAttr('tutorial')) {
          button.removeClass('toggle')

          $fullModDescEditArea.val($fullModDescEditArea.attr('tutorial'))
          $fullModDescEditArea.removeAttr('tutorial')
        } else {
          button.addClass('toggle')

          $fullModDescEditArea.attr('tutorial', $fullModDescEditArea.val())
          $fullModDescEditArea.val('[h1]Гайд По Форматированию![/h1]\n\nФорматирование работает как в [b]полном[/b] описании мода, так и в [i]коротком[/i].\n\nФорматирование поддерживает заголовки от 1 до 6 (от большего к меньшему).\nФорматирование в виде добавления ссылок как вида https://openworkshop.su , так и [url=https://openworkshop.su]текста с гиперссылкой[/url]\n\nТак же можно вставлять ссылки на изображения:\n[img]https://cdn.akamai.steamstatic.com/steam/apps/105600/header.jpg?t=1666290860[/img]\n\nА ещё можно создать список:\n[list]\n[*] Первый пункт\n[*] Второй пункт\n[/list]\n\n[h5]Удачи в разработке![/h5]')
        }

        fullDescUpdate($fullModDescEditArea)
        $fullModDescView.html(OpenWS.syntaxToHTML($fullModDescEdit.find('textarea.editing').val()))
      }
    </script>
{% endblock %}

{% block title %}
{{ data[0]['result']['name'] }} - edit Open Work
{% endblock %}

{% block description %}
{{ data[0]['result']['short_description'] }}
{% endblock %}
